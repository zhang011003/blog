# Eureka客户端和服务端交互步骤

## 注册

Eureka客户端将运行信息注册到Eureka服务端。注册在第一次心跳时发生（30秒后）

## 续约

Eureka客户端需要每隔30秒通过心跳方式进行续约。续约的目的就是通知Eureka服务端当前实例还存活。如果服务端90秒内没有收到续约请求，则会将客户端实例从注册信息中移除。建议最好不要修改续约间隔，因为服务端会通过该信息判断是否和客户端通信有大范围的问题存在。

## 获取注册信息

Eureka客户端会从服务端获取注册信息并缓存到本地。之后会使用该信息查找其它的服务。注册信息会比较上次获取周期和本次获取周期的差值更新（delta updates），然后进行周期性更新（每30秒一次）。差值信息在服务端会保存较长时间（大概3分钟），因为差值获取可能获取到相同的实例信息。Eureka客户端会自动处理重复信息。

当Eureka客户端获取到差异信息后，会从服务端重新获取一遍

## 注销

当Eureka客户端关闭时，会发送注销请求到服务端。这样会从服务端注册信息中将该实例删除。

## 时间延期

Eureka客户端的所有操作都会在一定时间后在服务端以及其它客户端上体现。这是因为服务端的负载缓存是周期性刷新的。Eureka客户端也会周期性获取变更信息。因此所有客户端都知道变更信息可能要花费2分钟时间。

## 参考
> [Understanding eureka client server communication](https://github.com/Netflix/eureka/wiki/Understanding-eureka-client-server-communication)


